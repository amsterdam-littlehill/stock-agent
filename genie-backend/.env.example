# Stock Agent Genie Backend Environment Configuration
# 复制此文件为 .env 并根据实际环境修改配置值

# ===========================================
# 基础配置
# ===========================================

# Spring Boot 配置
SPRING_PROFILES_ACTIVE=dev
SERVER_PORT=8080
LOGGING_LEVEL=INFO

# ===========================================
# 数据库配置
# ===========================================

# MySQL 数据库配置
DB_HOST=localhost
DB_PORT=3306
DB_NAME=stock_agent_genie
DB_USERNAME=stockagent
DB_PASSWORD=StockAgent@2024
DB_ROOT_PASSWORD=StockAgent@2024

# 数据库连接池配置
DB_MAX_POOL_SIZE=20
DB_MIN_IDLE=5
DB_CONNECTION_TIMEOUT=30000
DB_IDLE_TIMEOUT=600000
DB_MAX_LIFETIME=1800000

# ===========================================
# Redis 配置
# ===========================================

# Redis 缓存配置
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DATABASE=0
REDIS_TIMEOUT=5000

# Redis 连接池配置
REDIS_MAX_ACTIVE=20
REDIS_MAX_IDLE=10
REDIS_MIN_IDLE=5
REDIS_MAX_WAIT=5000

# ===========================================
# AI 服务配置
# ===========================================

# OpenAI API 配置
OPENAI_API_KEY=your_openai_api_key_here
OPENAI_BASE_URL=https://api.openai.com
OPENAI_MODEL=gpt-4
OPENAI_MAX_TOKENS=4000
OPENAI_TEMPERATURE=0.7
OPENAI_TIMEOUT=60000

# 智能体配置
AGENT_MAX_CONCURRENT=5
AGENT_TIMEOUT=120000
AGENT_MAX_RETRIES=3

# ===========================================
# 工作流引擎配置
# ===========================================

# 工作流执行配置
WORKFLOW_MAX_CONCURRENT=10
WORKFLOW_TIMEOUT=300000
WORKFLOW_MAX_RETRIES=3
WORKFLOW_RETRY_DELAY=5000

# 工作流存储配置
WORKFLOW_MAX_HISTORY_DAYS=30
WORKFLOW_CLEANUP_INTERVAL=3600000

# ===========================================
# MCP 工具配置
# ===========================================

# MCP 工具执行配置
MCP_TIMEOUT=30000
MCP_MAX_RETRIES=3
MCP_RETRY_DELAY=1000
MCP_MAX_CONCURRENT=5

# MCP 工具健康检查
MCP_HEALTH_CHECK_INTERVAL=60000
MCP_HEALTH_CHECK_TIMEOUT=10000

# ===========================================
# WebSocket 配置
# ===========================================

# WebSocket 连接配置
WEBSOCKET_MAX_CONNECTIONS=100
WEBSOCKET_MESSAGE_SIZE_LIMIT=65536
WEBSOCKET_HEARTBEAT_INTERVAL=30000
WEBSOCKET_CONNECTION_TIMEOUT=60000

# ===========================================
# 安全配置
# ===========================================

# JWT 配置
JWT_SECRET=your_jwt_secret_key_here_must_be_at_least_256_bits
JWT_EXPIRATION=86400000
JWT_REFRESH_EXPIRATION=604800000

# CORS 配置
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8080
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=*
CORS_ALLOW_CREDENTIALS=true

# ===========================================
# 文件上传配置
# ===========================================

# 文件上传限制
FILE_MAX_SIZE=10MB
FILE_MAX_REQUEST_SIZE=50MB
FILE_UPLOAD_PATH=/app/data/uploads

# ===========================================
# 监控配置
# ===========================================

# Actuator 端点配置
MANAGEMENT_PORT=8081
MANAGEMENT_ENDPOINTS=health,info,metrics,prometheus

# Prometheus 监控
PROMETHEUS_PORT=9090
GRAFANA_PORT=3000
GRAFANA_PASSWORD=admin

# ===========================================
# 邮件配置
# ===========================================

# SMTP 邮件配置
MAIL_HOST=smtp.gmail.com
MAIL_PORT=587
MAIL_USERNAME=your_email@gmail.com
MAIL_PASSWORD=your_email_password
MAIL_FROM=noreply@stockagent.com
MAIL_SMTP_AUTH=true
MAIL_SMTP_STARTTLS=true

# ===========================================
# 外部服务配置
# ===========================================

# 股票数据源配置
STOCK_DATA_API_KEY=your_stock_data_api_key
STOCK_DATA_BASE_URL=https://api.stockdata.com
STOCK_DATA_TIMEOUT=30000

# 新闻数据源配置
NEWS_API_KEY=your_news_api_key
NEWS_BASE_URL=https://newsapi.org
NEWS_TIMEOUT=30000

# ===========================================
# Docker 配置
# ===========================================

# Nginx 配置
NGINX_PORT=80
NGINX_SSL_PORT=443

# 容器资源限制
CONTAINER_MEMORY_LIMIT=2g
CONTAINER_CPU_LIMIT=1.0

# ===========================================
# 开发环境配置
# ===========================================

# 开发工具配置
DEV_TOOLS_ENABLED=true
DEV_TOOLS_RESTART=true
DEV_TOOLS_LIVERELOAD=true

# H2 数据库配置（开发环境）
H2_CONSOLE_ENABLED=true
H2_CONSOLE_PATH=/h2-console

# ===========================================
# 测试环境配置
# ===========================================

# 测试数据库配置
TEST_DB_URL=jdbc:h2:mem:testdb
TEST_DB_USERNAME=sa
TEST_DB_PASSWORD=

# ===========================================
# 生产环境配置
# ===========================================

# 生产环境安全配置
PROD_SECURITY_REQUIRE_SSL=true
PROD_SECURITY_HSTS_ENABLED=true
PROD_SECURITY_CONTENT_SECURITY_POLICY=default-src 'self'

# 生产环境性能配置
PROD_JVM_XMS=1g
PROD_JVM_XMX=4g
PROD_JVM_GC=G1GC

# 生产环境监控配置
PROD_MONITORING_ENABLED=true
PROD_METRICS_EXPORT_ENABLED=true
PROD_HEALTH_CHECK_ENABLED=true

# ===========================================
# 备份和恢复配置
# ===========================================

# 数据库备份配置
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=7
BACKUP_PATH=/app/data/backups

# ===========================================
# 日志配置
# ===========================================

# 日志级别配置
LOGGING_LEVEL_ROOT=INFO
LOGGING_LEVEL_COM_JD_GENIE=DEBUG
LOGGING_LEVEL_ORG_SPRINGFRAMEWORK=INFO
LOGGING_LEVEL_ORG_HIBERNATE=WARN

# 日志文件配置
LOGGING_FILE_PATH=/app/logs
LOGGING_FILE_MAX_SIZE=100MB
LOGGING_FILE_MAX_HISTORY=30
LOGGING_FILE_TOTAL_SIZE_CAP=1GB

# ===========================================
# 缓存配置
# ===========================================

# 应用缓存配置
CACHE_TYPE=redis
CACHE_TTL=3600
CACHE_MAX_SIZE=1000

# 缓存预热配置
CACHE_WARMUP_ENABLED=true
CACHE_WARMUP_DELAY=60000

# ===========================================
# 限流配置
# ===========================================

# API 限流配置
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=100
RATE_LIMIT_BURST_CAPACITY=200

# ===========================================
# 健康检查配置
# ===========================================

# 应用健康检查
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=10

# 依赖服务健康检查
HEALTH_CHECK_DB_ENABLED=true
HEALTH_CHECK_REDIS_ENABLED=true
HEALTH_CHECK_EXTERNAL_APIS_ENABLED=true